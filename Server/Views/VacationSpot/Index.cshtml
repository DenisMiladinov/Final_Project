@model IEnumerable<Models.VacationSpot>
@{
    Layout = "_Layout";
    ViewData["Title"] = "Destinations";
}

@section Styles {
    <link rel="stylesheet"
          href="~/css/Views/VacationSpot/Index.css"
          asp-append-version="true" />
}

<section class="section__container destination__container">
    <div class="section__header">
        <div>
            <h2 class="section__title">Explore top destinations</h2>
            <p class="section__subtitle">
                Discover our most popular vacation spots around the world.
            </p>
        </div>
        <div class="destination__nav">
            <i class="ri-arrow-left-s-line"></i>
            <i class="ri-arrow-right-s-line"></i>
        </div>
        <form class="spot-search" method="get" asp-action="Index">
            <input type="text"
                   name="search"
                   class="spot-search__input"
                   placeholder="Type to seach"
                   value="@(ViewData["CurrentFilter"] ?? "")" />
            <button type="submit" class="spot-search__btn">
                <i class="fa-solid fa-magnifying-glass"></i>
            </button>
        </form>
    </div>
    <div class="destination__grid">
        @foreach (var spot in Model)
        {
            <div class="vacation-card">
                <img src="@(Url.Content($"~/assets/Spots/{spot.Images.First().ImageUrl.Split('/').Last()}"))" alt="@spot.Title" />
                <h3>@spot.Title</h3>
                <p>@spot.Location</p>
                <p>From @spot.PricePerNight lv</p>
            </div>
        }
    </div>
</section>

@section Scripts {
    <script>
        document.querySelector('.spot-search__input').addEventListener('input', function() {
            const q = this.value.toLowerCase();
            document.querySelectorAll('.vacation-card').forEach(card => {
                const txt = (
                    card.querySelector('h3').textContent +
                    card.querySelector('p').textContent
                ).toLowerCase();
                card.style.display = txt.includes(q) ? '' : 'none';
            });
        });
    </script>
}